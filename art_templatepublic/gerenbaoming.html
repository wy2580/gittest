<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
    <link rel="stylesheet" type="text/css" href="styles/mobile-reset.css">
    <link rel="stylesheet" href="styles/index.css">
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/chuanduizuye.css">
     <script type="text/javascript" src="js/base.js"></script>
</head>
<body>
	<!-- head部分开始 -->
	<div class="zsaichuanxiangjie wapper hidden zbaomingxitong">
		<a href="javascript:;" class="back"></a>
		<h3 class="ztitle zhuanghaibei"></h3>
		<a href="gerenyemian.html" class="shipinsuoluetu hidden" id="cdbmzhuyetouxiang">
			<img src="images/headsuoluetu.png" alt="" class="headsuoluetu">
		</a>
	</div>
	<!-- head部分结束 -->
	<!-- 船队报名系列部分内容开始 -->
	<div id="teamListContainer" class="wapper hidden grbmkuang">
		<div class="zfenlei hidden">
			<a href="chuanduibaoming.html" class="zfenleia zfenleia1">船队报名</a>
			<a href="gerenbaoming.html" class="zfenleia">个人报名</a>
		</div>
		<!--div class="wapper grbmzycon">
			<div class="consafe">
				<div class="grbmpart hidden">
					<a href="javascript:;" class="grbmimga"></a>
					<div class="grbmzymid hidden">
						<h3 class="grbmzyh3">菜鸟1号帆船队<span class="grbmstate">[审核中]</span></h3>
						<p class="grbmzyp">组别：珐伊28R</p>
						<p class="grbmzyp">船员：张海波/（船队组建中）</p>
					</div>
					
					<div class="gebmjbguanjun">
						<div class="first">
							<img src="images/first.svg" alt="" class="firstimg">
							<span class="jbcount small-font smallsize-font">9</span>
						</div>
						<div class="first">
							<img src="images/second.svg" alt="" class="firstimg">
							<span class="jbcount">6</span>
						</div>
						<div class="first">
							<img src="images/third.svg" alt="" class="firstimg">
							<span class="jbcount">5</span>
						</div>
					</div>
				</div>	
				<p class="cdsywenzip grbmwenzip">这是一只战无不胜、走南闯北的船队，先后获得黄海杯总冠军，3次中国杯冠军、2次中国杯季军，中韩帆船拉力赛季军，参加10次CCOR帆船赛，获得8块奖…</p>
				<a href="querenshenqing.html" class="grbmshenqingjiaru">申请加入</a>
			</div>
		</div-->
		
		<!--div class="wapper grbmzycon">
			<div class="consafe">
				<div class="grbmpart hidden">
					<a href="javascript:;" class="grbmimga grbmimga2"></a>
					<div class="grbmzymid hidden">
						<h3 class="grbmzyh3">新梦想帆船队<span class="grbmstate grbmstate2">[报名成功]</span></h3>
						<p class="grbmzyp">参赛组别：B40.7</p>
						<p class="grbmzyp">船员：张生良/张海波、余浩、马洪成、黄克、刘开运。</p>
					</div>
					
					<div class="gebmjbguanjun">
						<div class="first">
							<img src="images/first.svg" alt="" class="firstimg">
							<span class="jbcount small-font smallsize-font">9</span>
						</div>
						<div class="first">
							<img src="images/second.svg" alt="" class="firstimg">
							<span class="jbcount">6</span>
						</div>
						<div class="first">
							<img src="images/third.svg" alt="" class="firstimg">
							<span class="jbcount">5</span>
						</div>
					</div>
				</div>	
				<p class="cdsywenzip grbmwenzip">这是一只战无不胜、走南闯北的船队，先后获得黄海杯总冠军，3次中国杯冠军、2次中国杯季军，中韩帆船拉力赛季军，参加10次CCOR帆船赛，获得8块奖…</p>
				<a href="javascript:;" class="grbmshenqingjiaru grbmshenqingjiaru2">船员已满</a>
			</div>
		</div-->

		<!--div class="wapper grbmzycon">
			<div class="consafe">
				<div class="grbmpart hidden">
					<a href="javascript:;" class="grbmimga grbmimga3"></a>
					<div class="grbmzymid hidden">
						<h3 class="grbmzyh3">大连海事大学帆船队<span class="grbmstate">[审核通过]</span></h3>
						<p class="grbmzyp">参赛组别：J80</p>
						<p class="grbmzyp">船员：张海波/余浩、马洪成、黄克、刘开运（剩1个空位）。</p>
					</div>
					
					<div class="gebmjbguanjun">
						<div class="first">
							<img src="images/first.svg" alt="" class="firstimg">
							<span class="jbcount small-font smallsize-font">9</span>
						</div>
						<div class="first">
							<img src="images/second.svg" alt="" class="firstimg">
							<span class="jbcount">6</span>
						</div>
						<div class="first">
							<img src="images/third.svg" alt="" class="firstimg">
							<span class="jbcount">5</span>
						</div>
					</div>
				</div>	
				<p class="cdsywenzip grbmwenzip">这是一只战无不胜、走南闯北的船队，先后获得黄海杯总冠军，3次中国杯冠军、2次中国杯季军，中韩帆船拉力赛季军，参加10次CCOR帆船赛，获得8块奖…</p>
				<a href="querenshenqing.html" class="grbmshenqingjiaru">申请加入</a>
			</div>
		</div-->
	</div>
	<!-- 船队报名系列部分内容结束 -->
	
</body>
<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="js/jquery.cookie.js"></script>
<script type="text/javascript" src="js/fastclick.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<script type="text/javascript" src="js/lib.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<script>
    //原来的页面初始化
    $(function(){
        $(".zfenlei a").css({color:"#fff",borderBottom:"none"});
        $(".zfenlei a").eq(1).css({color:"#00b1ff",borderBottom:".04rem solid #00b1ff"});
        $(".zfenlei a").on("click",function(){
            $(".zfenlei a").css({color:"#fff",borderBottom:"none"});
            $(this).css({color:"#00b1ff",borderBottom:".04rem solid #00b1ff"});
        });
    });
	//页面初始化
    $(function(){
        var teamsInfo = getMatchTeams();
        var isJoin = teamsInfo.isJoin;
        var teams = teamsInfo.teams;
        for(var i in teams){
            var team = teams[i];
            var itemObj = getTeamItem(team);
            if(team.isFull+'' === '1'){
                itemObj.find('.isFull').addClass('grbmshenqingjiaru2').attr('href', 'javascript:void(0);').text('船员已满');
            }
            if(isJoin){
                if(team['isJoin']+'' === '1'){
                    itemObj.find('.isFull').attr('href', 'javascript:void(0);').text(team['joinInfo']);
                }else{
                    itemObj.css('padding-bottom', '0.24em');
                    itemObj.find('.isFull').hide();
                }
            }
            itemObj.appendTo($('#teamListContainer'));
        }
    });
    //获取船队条目
    function getTeamItem(team){
        return $([
            '<div class="wapper grbmzycon">',
            '    <div class="consafe">',
            '        <div class="grbmpart hidden">',
            '            <img class="grbmimga grbmimga2" src="'+formatFileUrl(team['icon'], '/images/14.png')+'?imageView2/1/w/160/h/190'+'" style="width:1.6rem;height:auto;"/>',
            '            <div class="grbmzymid hidden">',
            '                <h3 class="grbmzyh3">'+team['name']+'</h3>',
            '                <p class="grbmzyp">参赛组别：'+team['sailingName']+'</p>',
            '                <p class="grbmzyp">船员：'+(team['membersName'] || '').substr(0, 28)+((team['membersName'] || '').length > 28 ? '...' : '')+'</p>',
            '            </div>',
            '            <div class="gebmjbguanjun">',
            '            </div>',
            '        </div>',
            '        <p class="cdsywenzip grbmwenzip">'+(team.description || '').substr(0, 70)+((team.description || '').length > 70 ? '...' : '')+'</p>',
            '        <a href="javascript:applyToJoinTeam(\''+team.teamId+'\');" class="grbmshenqingjiaru isFull">申请加入</a>',
            '    </div>',
            '</div>'
        ].join(''));
    }
    //获取所有船队
    function getMatchTeams(){
        return getData({
            url : '/team/getMatchTeamList',
            data : {matchId : getMatchId()}
        });
    }
    //报名
    function applyToJoinTeam(teamId){
        if(!loginCheck()){
            return ;
        }
        $.cookie('applyToJoinTeamMatchId', null);
        $.cookie('applyToJoinTeamId', teamId);
        window.location.href="querenshenqing.html";
    }
    //比赛名
    $(".ztitle").text(saveMatchName());
    document.title=saveMatchName();
</script>
</html>